var Gnuplot=function(t){this.worker=new Worker(t),this.output=[],this.error=[],this.isRunning=!1,this.onOutput=function(e){console.log("Gnuplot output: "+e)},this.onError=function(e){console.log("Gnuplot error: "+e)},this.transaction=1,this.callbacks=[],this.postCommand=function(e,n){var t=this.transaction;e.transaction=t,this.callbacks[t]=n,this.worker.postMessage(e),this.transaction++};var e=this;this.worker.addEventListener("message",function(n){var t=n.data;if(t.transaction<0){t.transaction==-1&&(e.output.push(t.content),e.onOutput(t.content)),t.transaction==-2&&(e.error.push(t.content),e.onError(t.content));return}t.content=="FINISH"&&(e.isRunning=!1),t.transaction&&e.callbacks[t.transaction]&&(e.callbacks[t.transaction](t),delete e.callbacks[t.transaction])},!1),this.worker.postMessage({})};Gnuplot.prototype.putFile=function(e,t){var n={name:e,content:t,cmd:"putFile"};this.postCommand(n,null)},Gnuplot.prototype.getFile=function(e,t){var n={name:e,cmd:"getFile"};this.postCommand(n,t)},Gnuplot.prototype.run=function(e,t){if(this.isRunning)return!1;this.putFile("foo",e);var n={content:["foo"],cmd:"run"};return this.isRunning=!0,this.postCommand(n,t),!0}